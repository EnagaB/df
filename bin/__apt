#!/usr/bin/env bash
set -u

function __echo_helptext() {
  echo "upd - Update packages."
  echo ""
  echo "Usage: upd <command> <subcommand>"
  echo ""
  echo "command and subcommand:"
  echo ""
  echo "  apt                  : Ubuntu package manager."
  echo "      without_arguments: update and upgrade."
  echo "      full             : update and full-upgrade and clean."
}

function __upd_apt() {
  if [[ "$#" -eq 0 ]]; then
    sudo apt update && sudo apt -y upgrade
  elif [[ "$1" = 'full' ]]; then
    if (sudo apt update); then
      sudo apt -y full-upgrade
      sudo apt -y autoremove
      sudo apt -y autoclean
    fi
  else
    __echo_helptext
  fi
}

if [[ "$#" -eq 0 ]] || [[ "$#" -ge 3 ]]; then
  __echo_helptext
  exit 1
fi

cmd="$1"
shift 1

if [[ "$cmd" = 'apt' ]]; then
  __upd_apt "$@"
else
  __echo_helptext
  exit 1
fi

# EOF
