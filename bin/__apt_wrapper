#!/usr/bin/env bash
set -u

function __echo_helptext() {
  echo "__apt_wrapper - apt wrapper."
  echo ""
  echo "Usage: __apt_wrapper <command> ..."
  echo ""
  echo "command:"
  echo ""
  echo "  eupgrade     : Update and upgrade."
  echo "  efull-upgrade: Update and full-upgrade."
  echo "               : After that, remove unrequired packages and caches."
  echo "  einstall     : Update and upgrade and install packages."
  echo "  help         : Display help text."
  echo ""
  echo "If a command other than the above is given, it is given to 'apt'."
  echo "If a command is not given, display help text."
  echo ""
  echo "apt help"
  apt help "$@"
}

if [[ "$#" -eq 0 ]]; then
  __echo_helptext
  exit 0
fi

declare -r cmd="$1"

if [[ "$cmd" = "eupgrade" ]]; then
  sudo apt update && sudo apt -y upgrade
elif [[ "$cmd" = "efull-upgrade" ]]; then
  if (sudo apt update); then
    sudo apt -y full-upgrade
    sudo apt -y autoremove
    sudo apt -y autoclean
  fi
elif [[ "$cmd" = "einstall" ]]; then
  shift 1
  sudo apt update && sudo apt -y upgrade && sudo apt -y install "$@"
elif [[ "$cmd" = "help" ]]; then
  shift 1
  __echo_helptext "$@"
else
  sudo apt "$@"
fi

exit 0

# EOF
